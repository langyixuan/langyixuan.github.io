(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{558:function(t,s,a){"use strict";a.r(s);var e=a(17),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"浏览器本地存储"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浏览器本地存储"}},[t._v("#")]),t._v(" 浏览器本地存储")]),t._v(" "),a("p",[t._v("近年来，随着浏览器存储技术的提升，出现了多种前端存储方式。比如："),a("code",[t._v("cookie")]),t._v("、"),a("code",[t._v("localStorage")]),t._v("、"),a("code",[t._v("sessionStorage")]),t._v("、"),a("code",[t._v("Web SQL")]),t._v("、"),a("code",[t._v("indexedDB")]),t._v("。 对于前三种方式想必大家耳熟能详，因为 cookie、localStorage、sessionStorage 都属于 js 语言的本地存储，而 Web SQL 和 indexedDB 则是一种前端存储数据库。 这篇文章会分别介绍这五种存储方式，以及他们之间的差异及优缺点。")]),t._v(" "),a("h2",{attrs:{id:"一、cookie"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、cookie"}},[t._v("#")]),t._v(" 一、Cookie")]),t._v(" "),a("h3",{attrs:{id:"🍪-什么是-cookie"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#🍪-什么是-cookie"}},[t._v("#")]),t._v(" 🍪 什么是 Cookie")]),t._v(" "),a("p",[a("code",[t._v("Cookie")]),t._v("是最早被提出来的本地存储⽅式，在此之前，服务端是⽆法判断⽹络中的两个请求是否是同⼀⽤户发起的，也就是无法辨别用户身份，为解决这个问题，Cookie 就出现了。Cookie 的⼤⼩只有 4kb，它是⼀种纯⽂本⽂件，每次发起 HTTP 请求都会携带 Cookie。")]),t._v(" "),a("p",[a("code",[t._v("Cookie")]),t._v(" 主要用于以下三个方面：")]),t._v(" "),a("ul",[a("li",[t._v("会话状态管理（如用户登录状态、购物车、游戏分数或其它需要记录的信息）")]),t._v(" "),a("li",[t._v("个性化设置（如用户自定义设置、主题等）")]),t._v(" "),a("li",[t._v("浏览器行为跟踪（如跟踪分析用户行为等）")])]),t._v(" "),a("h3",{attrs:{id:"📥-cookie-的存储"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#📥-cookie-的存储"}},[t._v("#")]),t._v(" 📥 Cookie 的存储")]),t._v(" "),a("p",[a("code",[t._v("Cookie")]),t._v("总是保存在客户端中，按在客户端中的存储位置，"),a("mark",[t._v("Cookie 可以分为内存 Cookie 和硬盘 Cookie")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("内存Cookie")]),t._v("由浏览器进行维护，保存在内存中，浏览器关闭时 Cookie 就会消失，其存在时间是短暂的。")]),t._v(" "),a("li",[a("code",[t._v("硬盘Cookie")]),t._v("保存在硬盘中，有一个过期时限，用户手动清除或者过期时间到了，才会被清除。")])]),t._v(" "),a("p",[t._v("如何判断一个 cookie 是内存 cookie 还是硬盘 cookie?")]),t._v(" "),a("ul",[a("li",[t._v("没有设置过期时间，默认情况下 cookie 是内存 cookie，在关闭浏览器时会自动清除。")]),t._v(" "),a("li",[t._v("有设置过期时间，并且过期时间不为 0 或者负数的 cookie，时硬盘 cookie，需要手动或者到期，才会删除。")])]),t._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://s2.loli.net/2022/04/09/oy9XYLkSvAjedHs.png",alt:"image-20220409154738991"}}),t._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://s2.loli.net/2022/04/09/ETKFfo8Q3Iu2bNs.png",alt:"image-20220409154804599"}}),t._v(" "),a("h3",{attrs:{id:"✨-cookie-的特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#✨-cookie-的特性"}},[t._v("#")]),t._v(" ✨ Cookie 的特性")]),t._v(" "),a("ul",[a("li",[t._v("Cookie 一旦创建成功，"),a("code",[t._v("名称就无法修改")])]),t._v(" "),a("li",[t._v("Cookie 的"),a("code",[t._v("大小受限")]),t._v("，一般为 4kb，同一个域名下存放的 Cookie"),a("code",[t._v("个数有限")])]),t._v(" "),a("li",[t._v("Cookie"),a("code",[t._v("无法进行跨域")]),t._v("，也就是说 a 域名和 b 域名下的 cookie 时无法共享的，这是由 Cookie 的隐私安全性决定的，这样就能够阻止非法获取其他网站的 Cookie")]),t._v(" "),a("li",[t._v("每次发起同域下的 HTTP 请求，都会携带当前域名下的 Cookie")]),t._v(" "),a("li",[t._v("支持设置"),a("code",[t._v("HttpOnly")]),t._v("，防止 Cookie 被客户端的 JavaScript 访问")])]),t._v(" "),a("h3",{attrs:{id:"💫-cookie-的原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#💫-cookie-的原理"}},[t._v("#")]),t._v(" 💫 Cookie 的原理")]),t._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://s2.loli.net/2022/04/09/hrWEXmakUBf4Is1.jpg",alt:"Cookie原理"}}),t._v(" "),a("p",[t._v("第一次访问网站的时候，浏览器发出请求，服务器响应请求后，会在响应头里面添加一个 "),a("code",[t._v("Set-Cookie")]),t._v(" 选项，将 "),a("code",[t._v("Cookie")]),t._v(" 放入到响应请求中，在浏览器第二次发请求的时候，会通过 "),a("code",[t._v("Cookie")]),t._v(" 请求头部将 "),a("code",[t._v("Cookie")]),t._v(" 信息发送给服务器，服务端会辨别用户身份，另外 "),a("code",[t._v("Cookie")]),t._v(" 的过期时间、域、路径、有效期、适用站点都可以根据需要来指定。")]),t._v(" "),a("h3",{attrs:{id:"🌟-cookie-其字段及作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#🌟-cookie-其字段及作用"}},[t._v("#")]),t._v(" 🌟 Cookie 其字段及作用")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("字段名")]),t._v(" "),a("th",[t._v("作用")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Name")]),t._v(" "),a("td",[t._v("cookie 的名称")])]),t._v(" "),a("tr",[a("td",[t._v("Value")]),t._v(" "),a("td",[t._v("cookie 的值，对于认证 cookie，value 值包括 web 服务器所提供的访问令牌；")])]),t._v(" "),a("tr",[a("td",[t._v("Size")]),t._v(" "),a("td",[t._v("cookie 的⼤⼩")])]),t._v(" "),a("tr",[a("td",[t._v("Path")]),t._v(" "),a("td",[t._v("访问此 cookie 的⻚⾯路径")])]),t._v(" "),a("tr",[a("td",[t._v("Secure")]),t._v(" "),a("td",[t._v("指定是否使⽤ HTTPS 安全协议发送 Cookie")])]),t._v(" "),a("tr",[a("td",[t._v("Domain")]),t._v(" "),a("td",[t._v("可以访问该 cookie 的域名，Cookie 机制并未遵循严格的同源策略，允许⼀个⼦域可以设置或获取其⽗域的 Cookie。")])]),t._v(" "),a("tr",[a("td",[t._v("HTTPOnly")]),t._v(" "),a("td",[t._v("规定了这个 cookie 只能被服务器访问，不能使⽤ js 脚本访问")])]),t._v(" "),a("tr",[a("td",[t._v("Expires/Max-size")]),t._v(" "),a("td",[t._v("设置 cookie 的超时时间。不设置的话默认值是 Session，意思是 cookie 会和 session ⼀起失效。当浏览器关闭(不是浏览器标签⻚，⽽是整个浏览器) 后，此 cookie 失效。")])])])]),t._v(" "),a("h3",{attrs:{id:"🌈-cookie-的使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#🌈-cookie-的使用"}},[t._v("#")]),t._v(" 🌈 Cookie 的使用")]),t._v(" "),a("h4",{attrs:{id:"创建-cookie"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建-cookie"}},[t._v("#")]),t._v(" 创建 Cookie")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookie "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"username=langyixuan;"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建一个名为username的cookie")]),t._v("\ndocument"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookie "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"expires=Thu, 18 Dec 2043 12:00:00 GMT;"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置cookie的有效日期")]),t._v("\n")])])]),a("h4",{attrs:{id:"读取-cookie"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#读取-cookie"}},[t._v("#")]),t._v(" 读取 Cookie")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" x "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookie"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h4",{attrs:{id:"删除-cookie"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除-cookie"}},[t._v("#")]),t._v(" 删除 Cookie")]),t._v(" "),a("p",[t._v("删除 Cookie 非常简单,只需要设置"),a("code",[t._v("expires")]),t._v("参数为以前的时间即可，删除时不必指定 Cookie 的值。")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookie "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"username=; expires=Thu, 01 Jan 1970 00:00:00 GMT"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h4",{attrs:{id:"封装函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#封装函数"}},[t._v("#")]),t._v(" 封装函数")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 添加cookie")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setCookie")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" iDay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" oDate "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  oDate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setDate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oDate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" iDay"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookie "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" key "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"="')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" value "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('";expires="')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" oDate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 删除cookie")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeCookie")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setCookie")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//这里只需要把Cookie保质期退回一天便可以删除")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取cookie")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCookie")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" cookieArr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookie"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("split")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"; "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" cookieArr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" arr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cookieArr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("split")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"="')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("arr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" arr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"😑-cookie-的缺陷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#😑-cookie-的缺陷"}},[t._v("#")]),t._v(" 😑 Cookie 的缺陷")]),t._v(" "),a("p",[t._v("虽然 "),a("code",[t._v("Cookie")]),t._v(" 使用起来很方便，但是它还是存在着一些缺陷，如下:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Cookie")]),t._v(" 不够大，"),a("code",[t._v("Cookie")]),t._v(" 的大小限制在 "),a("code",[t._v("4KB")]),t._v(" 左右")]),t._v(" "),a("li",[a("code",[t._v("Cookie")]),t._v(" 是紧跟域名的，同一个域名下的所有请求，都会携带 "),a("code",[t._v("Cookie")]),t._v("，过多的 "),a("code",[t._v("Cookie")]),t._v(" 会带来巨大的性能浪费")]),t._v(" "),a("li",[t._v("由于在 "),a("code",[t._v("HTTP")]),t._v(" 请求中的 "),a("code",[t._v("Cookie")]),t._v(" 是明文传递的，所以安全性成问题，除非用 "),a("code",[t._v("HTTPS")])])]),t._v(" "),a("h3",{attrs:{id:"🚑-cookie-的安全性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#🚑-cookie-的安全性"}},[t._v("#")]),t._v(" 🚑 Cookie 的安全性")]),t._v(" "),a("p",[t._v("另外我们还需要注意 "),a("code",[t._v("Cookie")]),t._v(" 的安全性")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("属性")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("作用")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("value")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("如果用于保存用户登录态，应该将该值加密，不能使用明文的用户标识")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("http-only")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("不能通过 "),a("code",[t._v("JavaScript")]),t._v(" 访问 "),a("code",[t._v("Cookie")]),t._v("，减少 "),a("code",[t._v("XSS")]),t._v(" 攻击")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("secure")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("只能在协议为 "),a("code",[t._v("HTTPS")]),t._v(" 的请求中携带")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("same-site")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("规定浏览器不能在跨域请求中携带 "),a("code",[t._v("Cookie")]),t._v("，减少 "),a("code",[t._v("CSRF")]),t._v(" 攻击")])])])]),t._v(" "),a("p",[a("code",[t._v("HttpOnly")]),t._v(" 不支持读写，浏览器不允许脚本操作去更改 "),a("code",[t._v("Cookie")]),t._v("，所以为避免跨域脚本（"),a("code",[t._v("XSS")]),t._v("）攻击，通过 "),a("code",[t._v("JavaScript")]),t._v(" 的 "),a("code",[t._v("document.cookie")]),t._v(" 无法访问带有 "),a("code",[t._v("HttpOnly")]),t._v(" 标记的 "),a("code",[t._v("Cookie")]),t._v("，它们只应该发送给服务端，如果包含服务端 "),a("code",[t._v("Session")]),t._v(" 信息的 "),a("code",[t._v("Cookie")]),t._v(" 不想被客户端 "),a("code",[t._v("JavaScript")]),t._v(" 脚本调用，那么就应该为其设置 "),a("code",[t._v("HttpOnly")]),t._v(" 标记，如下:")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Set"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Cookie"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("a3fWa"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Expires"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Wed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" Oct "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2018")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("07")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GMT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Secure"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" HttpOnly\n")])])]),a("p",[t._v("标记为 "),a("code",[t._v("Secure")]),t._v(" 的 "),a("code",[t._v("Cookie")]),t._v(" 只应通过被 "),a("code",[t._v("HTTPS")]),t._v(" 协议加密过的请求发送给服务端，但即便设置了 "),a("code",[t._v("Secure")]),t._v(" 标记，敏感信息也不应该通过 "),a("code",[t._v("Cookie")]),t._v("传输，因为 "),a("code",[t._v("Cookie")]),t._v(" 有其固有的不安全性，"),a("code",[t._v("Secure")]),t._v(" 标记也无法提供确实的安全保障。")]),t._v(" "),a("h2",{attrs:{id:"二、localstorage-和-sessionstorage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、localstorage-和-sessionstorage"}},[t._v("#")]),t._v(" 二、LocalStorage 和 SessionStorage")]),t._v(" "),a("p",[a("code",[t._v("LocalStorage与SessionStorage")]),t._v("是 HTML5 新引⼊的特性，用于进行本地存储。由于有的时候我们存储的信息较⼤，Cookie 就不能满⾜我们的需求，这时候"),a("code",[t._v("LocalStorage和SessionStorage")]),t._v("就派上⽤场了。")]),t._v(" "),a("p",[t._v("LocalStorage 与 SessionStorage 两者的使用非常相似，只是在存储时效上有差异。")]),t._v(" "),a("h3",{attrs:{id:"💙-localstorage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#💙-localstorage"}},[t._v("#")]),t._v(" 💙 LocalStorage")]),t._v(" "),a("p",[t._v("一种 "),a("mark",[t._v("持久化的存储方式")]),t._v(" ，也就是说如果不手动清除，数据就永远不会过期，它是采用键值对的方式存储数据，按域名将数据分别保存到对应数据库文件里，相比 "),a("code",[t._v("Cookie")]),t._v(" 来说，它能保存更大的数据。")]),t._v(" "),a("p",[t._v("👉 LocalStorage 的特点有以下：")]),t._v(" "),a("ul",[a("li",[t._v("大小限制为 "),a("code",[t._v("5MB ~ 10MB")])]),t._v(" "),a("li",[t._v("在同源的所有标签页和窗口之间共享数据")]),t._v(" "),a("li",[t._v("数据仅保存在客户端，不与服务器进行通信")]),t._v(" "),a("li",[t._v("数据持久存在且不会过期，重启浏览器后仍然存在")]),t._v(" "),a("li",[t._v("对数据的操作是同步的")])]),t._v(" "),a("p",[t._v("👉 LocalStorage 的优点：")]),t._v(" "),a("ul",[a("li",[t._v("在⼤⼩⽅⾯，LocalStorage 的⼤⼩⼀般为 5MB，可以储存更多的信息")]),t._v(" "),a("li",[t._v("LocalStorage 是持久储存，并不会随着⻚⾯的关闭⽽消失，除⾮主动清理，不然会永久存在")]),t._v(" "),a("li",[t._v("仅储存在本地，不像 Cookie 那样每次 HTTP 请求都会被携带")])]),t._v(" "),a("p",[t._v("👉 LocalStorage 的缺点：")]),t._v(" "),a("ul",[a("li",[t._v("存在浏览器兼容问题，IE8 以下版本的浏览器不⽀持")]),t._v(" "),a("li",[t._v("如果浏览器设置为隐私模式，那我们将⽆法读取到 LocalStorage")]),t._v(" "),a("li",[t._v("LocalStorage 受到同源策略的限制，即端⼝、协议、主机地址有任何⼀个不相同，都不会访问")])]),t._v(" "),a("p",[t._v("👉 LocalStorage 具体使用：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过 setItem() 增加一个数据项")]),t._v("\nlocalStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myName"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zhangsan"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过 getItem() 获取某个数据项")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" me "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" localStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myName"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过 removeItem() 移除某个数据项")]),t._v("\nlocalStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myName"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 移除所有数据项")]),t._v("\nlocalStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("clear")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("👉 LocalStorage 的使用场景：")]),t._v(" "),a("ul",[a("li",[t._v("有些⽹站有换肤的功能，这时候就可以将换肤的信息存储在本地的 LocalStorage 中，当需要换肤的时候，直接操作 LocalStorage 即可")]),t._v(" "),a("li",[t._v("在⽹站中的⽤户浏览信息也会存储在 LocalStorage 中，还有⽹站的⼀些不常变动的个⼈信息等也可以存储在本地的 LocalStorage 中")])]),t._v(" "),a("h3",{attrs:{id:"💚-sessionstorage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#💚-sessionstorage"}},[t._v("#")]),t._v(" 💚 SessionStorage")]),t._v(" "),a("p",[t._v("SessionStorage 和 LocalStorage 都是在 HTML5 才提出来的存储⽅案，"),a("code",[t._v("SessionStorage")]),t._v(" 主要⽤于 "),a("mark",[t._v("临时保存")]),t._v(" 同⼀窗⼝(或标签⻚)的数据，刷新⻚⾯时不会删除，关闭窗⼝或标签⻚之后将会删除这些数据。")]),t._v(" "),a("p",[t._v("👉 SessionStorage 的特点有以下：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("sessionStorage")]),t._v(" 的数据只存在于当前浏览器的标签页")]),t._v(" "),a("li",[t._v("数据在页面刷新后依然存在，但在关闭浏览器标签页之后数据就会被清除")]),t._v(" "),a("li",[t._v("与 "),a("code",[t._v("localStorage")]),t._v(" 拥有统一的 "),a("code",[t._v("API")]),t._v(" 接口")]),t._v(" "),a("li",[t._v("对数据的操作是同步的")])]),t._v(" "),a("p",[t._v("👉 SessionStorage 与 LocalStorage 对⽐：")]),t._v(" "),a("ul",[a("li",[t._v("SessionStorage 和 LocalStorage 都在"),a("code",[t._v("本地进⾏数据存储")])]),t._v(" "),a("li",[t._v("SessionStorage 也有"),a("code",[t._v("同源策略的限制")]),t._v("，但是 SessionStorage 有⼀条更加严格的限制， SessionStorage 只有在同⼀浏览器的同⼀窗⼝下才能够共享")]),t._v(" "),a("li",[t._v("LocalStorage 和 SessionStorage 都"),a("code",[t._v("不能被爬⾍爬取")])])]),t._v(" "),a("p",[t._v("👉 SessionStorage 具体使用：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过 setItem() 增加一个数据项")]),t._v("\nsessionStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myName"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zhangsan"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过 getItem() 获取某个数据项")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" me "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sessionStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myName"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过 removeItem() 移除某个数据项")]),t._v("\nsessionStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myName"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 移除所有数据项")]),t._v("\nsessionStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("clear")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("👉 SessionStorage 的使用场景:")]),t._v(" "),a("ul",[a("li",[t._v("由于 SessionStorage"),a("code",[t._v("具有时效性")]),t._v("，所以可以⽤来存储⼀些⽹站的游客登录的信息，还有临时的浏览记录的信息。当关闭⽹站之后，这些信息也就随之消除了。")])]),t._v(" "),a("h2",{attrs:{id:"三、web-sql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、web-sql"}},[t._v("#")]),t._v(" 三、Web SQL")]),t._v(" "),a("p",[a("code",[t._v("Web SQL")]),t._v(" 数据库 "),a("code",[t._v("API")]),t._v(" 实际上不是 "),a("code",[t._v("HTML5")]),t._v(" 规范的一部分，而是一个单独的规范，它引入了一组 "),a("code",[t._v("API")]),t._v(" 来使用 "),a("code",[t._v("SQL")]),t._v(" 来操作客户端数据库。")]),t._v(" "),a("blockquote",[a("p",[t._v("不过需要注意的是，"),a("code",[t._v("HTML5")]),t._v(" 已经放弃 "),a("code",[t._v("Web SQL")]),t._v(" 数据库")])]),t._v(" "),a("p",[t._v("👉 "),a("code",[t._v("Web SQL Database")]),t._v(" 规范中定义的三个核心方法，如下")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("openDatabase")]),t._v("，这个方法使用现有数据库或新建数据库来创建数据库对象")]),t._v(" "),a("li",[a("code",[t._v("transaction")]),t._v("，这个方法允许我们根据情况控制事务的提交或回滚")]),t._v(" "),a("li",[a("code",[t._v("executeSql")]),t._v("，这个方法用于执行真实的 "),a("code",[t._v("SQL")]),t._v(" 语句")])]),t._v(" "),a("p",[t._v("👉 "),a("code",[t._v("Web SQL")]),t._v(" 的特点（相比 "),a("code",[t._v("Cookie")]),t._v(" 与 "),a("code",[t._v("WebStorage")]),t._v(" 而言）")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Web SQL")]),t._v(" 能方便进行对象存储")]),t._v(" "),a("li",[a("code",[t._v("Web SQL")]),t._v(" 支持事务，能方便地进行数据查询和数据处理操作")])]),t._v(" "),a("p",[t._v("👉 具体使用方式如下")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" db "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("openDatabase")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mydb"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Test DB"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("transaction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("tx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 执行查询操作")]),t._v("\n  tx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("executeSql")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CREATE TABLE IF NOT EXISTS LOGS (id unique, log)"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 执行插入操作")]),t._v("\n  tx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("executeSql")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'INSERT INTO LOGS (id, log) VALUES (1, \"foobar\")'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  tx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("executeSql")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'INSERT INTO LOGS (id, log) VALUES (2, \"logmsg\")'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"四、indexeddb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、indexeddb"}},[t._v("#")]),t._v(" 四、IndexedDB")]),t._v(" "),a("p",[t._v("👉 详细内容可参考 "),a("a",{attrs:{href:"https://www.ruanyifeng.com/blog/2018/07/indexeddb.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("浏览器数据库 IndexedDB 入门教程")])]),t._v(" "),a("p",[t._v("现有的浏览器数据储存方案，都不适合储存大量数据：Cookie 的大小不超过 4KB，且每次请求都会发送回服务器；LocalStorage 在 2.5MB 到 10MB 之间（各家浏览器不同），而且不提供搜索功能，不能建立自定义的索引。所以，需要一种新的解决方案，这就是 IndexedDB 诞生的背景。")]),t._v(" "),a("p",[a("code",[t._v("IndexedDB")]),t._v(" 是一种底层 "),a("code",[t._v("API")]),t._v("，用于客户端存储大量结构化数据，包括文件、二进制大型对象，该 "),a("code",[t._v("API")]),t._v(" 使用索引来实现对该数据的高性能搜索。")]),t._v(" "),a("p",[t._v("👉 它的特点有以下这些：")]),t._v(" "),a("ul",[a("li",[t._v("键值对存储，"),a("code",[t._v("IndexedDB")]),t._v(" 内部采用对象仓库（"),a("code",[t._v("Object Store")]),t._v("）存放数据，所有类型的数据都可以直接存入，包括 "),a("code",[t._v("JavaScript")]),t._v(" 对象，对象仓库中，数据以键值对的形式保存，每一个数据记录都有对应的主键，主键是独一无二的，不能有重复，否则会抛出一个错误")]),t._v(" "),a("li",[t._v("数据操作是异步的，"),a("code",[t._v("IndexedDB")]),t._v(" 操作时不会锁死浏览器，用户依然可以进行其他操作，这与 "),a("code",[t._v("LocalStorage")]),t._v(" 形成对比，后者的操作是同步的，异步设计是为了防止大量数据的读写，拖慢网页的表现")]),t._v(" "),a("li",[t._v("存储空间大，"),a("code",[t._v("IndexedDB")]),t._v(" 的储存空间比 "),a("code",[t._v("LocalStorage")]),t._v(" 大得多，一般来说不少于 "),a("code",[t._v("250MB")]),t._v("，甚至没有上限")]),t._v(" "),a("li",[t._v("支持二进制存储，"),a("code",[t._v("IndexedDB")]),t._v(" 不仅可以储存字符串，还可以储存二进制数据（"),a("code",[t._v("ArrayBuffer")]),t._v(" 对象和 "),a("code",[t._v("Blob")]),t._v(" 对象）")]),t._v(" "),a("li",[t._v("同源限制，"),a("code",[t._v("IndexedDB")]),t._v(" 受到同源限制，每一个数据库对应创建它的域名，网页只能访问自身域名下的数据库，而不能访问跨域的数据库")]),t._v(" "),a("li",[t._v("支持事务型，"),a("code",[t._v("IndexedDB")]),t._v(" 支持事务（"),a("code",[t._v("transaction")]),t._v("），这意味着一系列操作步骤之中，只要有一步失败，整个事务就都取消，数据库回滚到事务发生之前的状态，不存在只改写一部分数据的情况")])]),t._v(" "),a("p",[t._v("👉 indexedDB 的基本使用：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" dbName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my_db"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" request "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" indexedDB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dbName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nrequest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onerror")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 错误处理")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nrequest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onupgradeneeded")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" db "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 建立一个对象仓库来存储我们客户的相关信息，我们选择 ssn 作为键路径（key path），因为 ssn 可以保证是不重复的")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" objectStore "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createObjectStore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"customers"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" keyPath"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ssn"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 建立一个索引来通过姓名来搜索客户，名字可能会重复，所以我们不能使用 unique 索引")]),t._v("\n  objectStore"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createIndex")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" unique"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用邮箱建立索引，我们确保客户的邮箱不会重复，所以我们使用 unique 索引")]),t._v("\n  objectStore"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createIndex")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"email"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"email"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" unique"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用事务的 oncomplete 事件确保在插入数据前对象仓库已经创建完毕")]),t._v("\n  objectStore"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("transaction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("oncomplete")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将数据保存到新创建的对象仓库")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" customerObjectStore "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" db\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("transaction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"customers"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"readwrite"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("objectStore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"customers"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    customerData"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("customer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      customerObjectStore"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("customer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),a("p",[t._v("该篇文章主要梳理了浏览器本地存储的五种方案的使用，分别是"),a("code",[t._v("Cookie")]),t._v("、"),a("code",[t._v("LocalStorage")]),t._v("、"),a("code",[t._v("SessionStorage")]),t._v("、"),a("code",[t._v("Web SQL")]),t._v("、"),a("code",[t._v("IndexedDB")]),t._v("。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/04/09/x51XMdkSPe3CspU.png",alt:"image-20220409173222751"}})]),t._v(" "),a("h2",{attrs:{id:"文章参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文章参考"}},[t._v("#")]),t._v(" 文章参考")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.loginradius.com/blog/engineering/guest-post/local-storage-vs-session-storage-vs-cookies/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Local Storage vs. Session Storage vs. Cookies")])]),t._v(" "),a("p",[a("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1839081",target:"_blank",rel:"noopener noreferrer"}},[t._v("各种浏览器存储方式总结")])]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.ruanyifeng.com/blog/2018/07/indexeddb.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("浏览器数据库 IndexedDB 入门教程")])])])}),[],!1,null,null,null);s.default=n.exports}}]);